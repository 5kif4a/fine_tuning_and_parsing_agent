# LLM Fine-tuning & Agent Project

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π: QA-–±–æ—Ç –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ –∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç-–≥–∏–¥ –ø–æ –ê–ª–º–∞—Ç—ã.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ main.ipynb                      # –ò—Å—Ç–æ—Ä–∏—è –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ QA-–±–æ—Ç (70%)
‚îú‚îÄ‚îÄ almaty_places_to_go_agent.ipynb # –ê–≥–µ–Ω—Ç "–ö—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å –≤ –ê–ª–º–∞—Ç—ã" (30%)
‚îú‚îÄ‚îÄ kz_history.pdf                  # –£—á–µ–±–Ω–∏–∫ –∏—Å—Ç–æ—Ä–∏–∏ (–∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
‚îú‚îÄ‚îÄ history.txt                     # –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (OCR)
‚îú‚îÄ‚îÄ history_sft_dataset.json        # SFT –¥–∞—Ç–∞—Å–µ—Ç (299 QA –ø–∞—Ä)
‚îú‚îÄ‚îÄ sxodim_data.json                # –°–ø–∞—Ä—Å–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å sxodim.com
‚îú‚îÄ‚îÄ sft_friendly_dataset.json       # SFT –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –¥—Ä—É–∂–µ–ª—é–±–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ agent_examples.md               # –ü—Ä–∏–º–µ—Ä—ã –¥–∏–∞–ª–æ–≥–æ–≤ –∞–≥–µ–Ω—Ç–∞
‚îî‚îÄ‚îÄ pyproject.toml                  # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
```

---

## –ß–∞—Å—Ç—å 1: –ò—Å—Ç–æ—Ä–∏—è –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ QA-–±–æ—Ç (70%)

### –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å, –æ—Ç–≤–µ—á–∞—é—â—É—é –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—á–µ–±–Ω–∏–∫–∞ 11 –∫–ª–∞—Å—Å–∞.

### Pipeline

```
PDF (—Å–∫–∞–Ω—ã) ‚Üí OCR (Docling + Surya) ‚Üí –¢–µ–∫—Å—Ç —É—á–µ–±–Ω–∏–∫–∞
     ‚Üì
LLM (GPT-4o-mini) ‚Üí SFT –¥–∞—Ç–∞—Å–µ—Ç (299 QA –ø–∞—Ä)
     ‚Üì
Qwen 2.5 3B + QLoRA ‚Üí Fine-tuned –º–æ–¥–µ–ª—å
     ‚Üì
Evaluation (BERTScore, BLEU)
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **OCR**: Docling + Surya OCR (—Ä—É—Å—Å–∫–∏–π –∏ –∫–∞–∑–∞—Ö—Å–∫–∏–π —è–∑—ã–∫–∏)
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞**: OpenAI GPT-4o-mini (async API)
- **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å**: Qwen/Qwen2.5-3B-Instruct
- **Fine-tuning**: QLoRA (LoRA rank=16, 0.96% –æ–±—É—á–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- **–û—Ü–µ–Ω–∫–∞**: BERTScore, BLEU

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –≠—Ç–∞–ø | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|------|-----------|
| OCR | 34,085 —Å–∏–º–≤–æ–ª–æ–≤ –∏–∑–≤–ª–µ—á–µ–Ω–æ |
| –î–∞—Ç–∞—Å–µ—Ç | 299 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö QA –ø–∞—Ä |
| –û–±—É—á–µ–Ω–∏–µ | Loss —Å–Ω–∏–∑–∏–ª—Å—è –Ω–∞ 82.83% |
| –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è | ~10 –º–∏–Ω—É—Ç (Apple M4 Pro) |

#### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –ú–æ–¥–µ–ª—å | BERTScore F1 | BLEU |
|--------|--------------|------|
| –ë–∞–∑–æ–≤–∞—è (Qwen 2.5 3B) | 0.6363 | 0.25 |
| Fine-tuned | 0.7153 | 5.97 |
| **–£–ª—É—á—à–µ–Ω–∏–µ** | **+12.4%** | **+2258%** |

### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

**–í–æ–ø—Ä–æ—Å:** –ö—Ç–æ —Ç–∞–∫–æ–π –•–æ–¥–∂–∞ –ê—Ö–º–µ–¥ –Ø—Å—Å–∞—É–∏?

**–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å:** –•–æ–¥–∂–∞ –ê—Ö–º–µ–¥ –Ø—Å—Å–∞—É–∏ (1870-1936) –±—ã–ª –æ–¥–Ω–∏–º –∏–∑ –≤–∞–∂–Ω–µ–π—à–∏—Ö –∫—Ä–µ–æ–ª—å—Å–∫–∏—Ö –ø–∏—Å–∞—Ç–µ–ª–µ–π... *(–Ω–µ–≤–µ—Ä–Ω–æ)*

**Fine-tuned –º–æ–¥–µ–ª—å:** –•–æ–¥–∂–∞ –ê—Ö–º–µ–¥ –Ø—Å—Å–∞—É–∏ –±—ã–ª –º—ã—Å–ª–∏—Ç–µ–ª–µ–º, —Ñ–∏–ª–æ—Å–æ—Ñ–æ–º... *(–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)*

---

## –ß–∞—Å—Ç—å 2: –ê–≥–µ–Ω—Ç "–ö—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å –≤ –ê–ª–º–∞—Ç—ã" (30%)

### –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–∞—Ä—Å–∏—Ç sxodim.com –∏ —Å–æ–≤–µ—Ç—É–µ—Ç –∫—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å –≤ –ê–ª–º–∞—Ç—ã.

### Pipeline

```
sxodim.com ‚Üí Crawl4AI ‚Üí Markdown
     ‚Üì
GPT-4o-mini ‚Üí –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON
     ‚Üì
LangChain Agent + Tools ‚Üí –î–∏–∞–ª–æ–≥–æ–≤—ã–π –±–æ—Ç
     ‚Üì
SFT (Qwen2.5-1.5B + QLoRA) ‚Üí –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Å—Ç–∏–ª—å
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **–ü–∞—Ä—Å–∏–Ω–≥**: Crawl4AI (headless browser)
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ**: OpenAI GPT-4o-mini
- **–ê–≥–µ–Ω—Ç**: LangChain + OpenAI Tools Agent
- **–ü–∞–º—è—Ç—å**: Chat History (HumanMessage/AIMessage)
- **SFT**: Qwen2.5-1.5B + QLoRA (Apple M4 Pro MPS)

### Tools (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–≥–µ–Ω—Ç–∞)

| Tool | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `search_places` | –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º |
| `get_places_by_category` | –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| `get_events` | –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è |
| `get_recommendations` | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–≤–æ–¥—É |
| `list_all_categories` | –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π |

### –ü—Ä–∏–º–µ—Ä—ã –¥–∏–∞–ª–æ–≥–æ–≤

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –ö—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö?

**–ê–≥–µ–Ω—Ç:** –ù–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –≤ –ê–ª–º–∞—Ç—ã –≤–∞—Å –∂–¥—É—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è!
1. **–ú–∏—à–∞ –ó–µ–π—Ñ–µ—Ä—Ç: —Å—Ç–µ–Ω–¥–∞–ø-–∫–æ–Ω—Ü–µ—Ä—Ç** - 27 —Ñ–µ–≤—Ä–∞–ª—è, –æ—Ç 5000 —Ç–µ–Ω–≥–µ
2. **–§–µ—Å—Ç–∏–≤–∞–ª—å Winter fest** - 31 —è–Ω–≤–∞—Ä—è, –æ—Ç 5000 —Ç–µ–Ω–≥–µ
3. **–°–ø–µ–∫—Ç–∞–∫–ª—å "–†–æ–∫-–Ω-—Ä–æ–ª–ª –Ω–∞ –∑–∞–∫–∞—Ç–µ"** - 30 —è–Ω–≤–∞—Ä—è, –æ—Ç 19000 —Ç–µ–Ω–≥–µ

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** –ö–∞–∫–∏–µ –∫–æ–Ω—Ü–µ—Ä—Ç—ã –±—É–¥—É—Ç?

**–ê–≥–µ–Ω—Ç:** –í–æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤:
- Maher Zain - 28 –º–∞—Ä—Ç–∞, –æ—Ç 10000 —Ç–µ–Ω–≥–µ
- Icegergert - 3 –∞–ø—Ä–µ–ª—è, 18000 —Ç–µ–Ω–≥–µ
- Therr Maitz - 17 –º–∞—Ä—Ç–∞, –æ—Ç 25000 —Ç–µ–Ω–≥–µ

### SFT –±–æ–Ω—É—Å (–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Å—Ç–∏–ª—å)

–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Qwen2.5-1.5B –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö GPT-4o-mini:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å | Qwen/Qwen2.5-1.5B-Instruct |
| –ú–µ—Ç–æ–¥ | QLoRA (rank=16, alpha=32) |
| –î–∞—Ç–∞—Å–µ—Ç | 15 –ø—Ä–∏–º–µ—Ä–æ–≤ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ |
| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | Apple M4 Pro (MPS) |
| –≠–ø–æ—Ö–∏ | 3 |

**–ü—Ä–∏–º–µ—Ä –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:**
> "–û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä! üé≠ –ù–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –≤ –ê–ª–º–∞—Ç—ã –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ! –†–µ–∫–æ–º–µ–Ω–¥—É—é —Å—Ç–µ–Ω–¥–∞–ø-–∫–æ–Ω—Ü–µ—Ä—Ç –ú–∏—à–∏ –ó–µ–π—Ñ–µ—Ä—Ç–∞ 27 —Ñ–µ–≤—Ä–∞–ª—è - —ç—Ç–æ –±—É–¥–µ—Ç –≤–µ—Å–µ–ª–æ! –ë–∏–ª–µ—Ç—ã –æ—Ç 5000 —Ç–µ–Ω–≥–µ. –•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –æ –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö?"

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.12+
- Poetry
- OpenAI API Key

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repo-url>
cd project

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
poetry install

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞
echo "OPENAI_API_KEY=your-key-here" > .env
```

### –ó–∞–ø—É—Å–∫

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
poetry shell

# –ó–∞–ø—É—Å–∫ Jupyter
jupyter notebook
```

1. **main.ipynb** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —è—á–µ–π–∫–∏ –¥–ª—è QA-–±–æ—Ç–∞
2. **almaty_places_to_go_agent.ipynb** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–ª—è –∞–≥–µ–Ω—Ç–∞

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```toml
# –û—Å–Ω–æ–≤–Ω—ã–µ
torch >= 2.0.0
transformers >= 4.40.0
peft >= 0.9.0
trl >= 0.8.0

# OCR
docling >= 1.0.0
surya-ocr >= 0.17.0

# Agent
langchain >= 0.3.0
langchain-openai >= 0.2.0
crawl4ai >= 0.4.0

# API
openai >= 1.12.0

# Metrics
bert-score >= 0.3.13
sacrebleu >= 2.4.0
```

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ - –ß–∞—Å—Ç—å 1 (70%)

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ë–∞–ª–ª—ã | –°—Ç–∞—Ç—É—Å |
|----------|-------|--------|
| OCR –≤—ã–ø–æ–ª–Ω–µ–Ω, —Ç–µ–∫—Å—Ç –∏–∑–≤–ª–µ—á–µ–Ω | 20 | ‚úÖ |
| –î–∞—Ç–∞—Å–µ—Ç —Å–æ–∑–¥–∞–Ω (100+ –ø–∞—Ä) | 20 | ‚úÖ 299 –ø–∞—Ä |
| –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ (loss —Å–Ω–∏–∑–∏–ª—Å—è) | 25 | ‚úÖ -82.83% |
| –ú–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã | 25 | ‚úÖ |
| –ö–æ–¥ —á–∏—Å—Ç—ã–π, —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ | 10 | ‚úÖ |

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ - –ß–∞—Å—Ç—å 2 (30%)

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ë–∞–ª–ª—ã | –°—Ç–∞—Ç—É—Å |
|----------|-------|--------|
| –°–∞–π—Ç —É—Å–ø–µ—à–Ω–æ —Å–ø–∞—Ä—Å–µ–Ω | 8 | ‚úÖ |
| –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã | 7 | ‚úÖ JSON |
| –ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã | 10 | ‚úÖ 6 –ø—Ä–∏–º–µ—Ä–æ–≤ |
| –ö–æ–¥ —á–∏—Å—Ç—ã–π, —Ä–∞–±–æ—Ç–∞–µ—Ç | 5 | ‚úÖ |
| **–ë–û–ù–£–°:** SFT –¥–ª—è –¥—Ä—É–∂–µ–ª—é–±–Ω–æ—Å—Ç–∏ | +30 | ‚úÖ Qwen2.5-1.5B + QLoRA |

---

## –ê–≤—Ç–æ—Ä

Alikhan Shorin

nFactorial Incubator 2025/2026 - LLM Engineer Track
